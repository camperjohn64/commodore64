;**************;*            *;* TITLE PAGE *;*            *;**************TITLE LDA #<IRQ2 LDY #>IRQ2 JSR SETIRQ;REPRG  BIT SKPNXT;       LDX #0;LPASD2 LDA #32;       STA $C000,X;       STA $C100,X;       STA $C200,X;       STA $C300,X;       LDA #1;       STA $C400,X;       STA $C500,X;       STA $C600,X;       STA $C700,X;       DEX;       BNE LPASD2;       LDX #FOREND-FORSTF;FORLP  LDA FORSTF-1,X;       CMP #64;       BCC ADDXZ;       AND #159;       EOR #128;ADDXZ  STA $C000+409,X;       DEX;       BNE FORLP;       JSR CLR;       LDX #39;       LDA #32;CLRSR  STA $0400,X;       DEX;       BPL CLRSR;       LDA #15;       LDX #0;       LDY #0;       JSR WAIT;       LDA #$4C;       STA REPRGSKPNXT JSR CLR3 JSR SAYMSG LDA #0 STA SOUND+24 LDA MSPEED STA TEMP5 LDX #4ADF113 LDA GRAPIC,X STA BUFFER,X DEX BNE ADF113 STX MEN JSR CLR3 LDA MAZE LDY MAZE+1 STA TEMP3 STY TEMP4 LDA #<ANIMM LDY #>ANIMM STA MAZE STY MAZE+1 JSR ANIMAT LDA #186 STA POS LDX #24MODLE2 LDA HISCR+7,X STA $0686,X LDA #1 STA $DA86,X DEX BNE MODLE2 LDA #15 LDY #0 LDX #0 JSR WAIT LDA #1 STA ANI LDA #0 STA XPOS+21 LDA TEMP5 STA MSPEED LDX #4ADF138 LDA BUFFER,X STA GRAPIC,X STA POS,X DEX BNE ADF138 LDA TEMP3 LDY TEMP4 STA MAZE STY MAZE+1 JSR MAZES JSR VIDEO LDA #200 STA SKILL JSR RESET JSR TOP JSR READYFKLOOP JSR DEATH JSR GHOST LDA #1 STA BON1 JSR BONUS JSR DEATH JSR P1CMAN LDY MSPEEDFKLOO2 DEY BNE FKLOO2 BEQ FKLOOPGORTS RTSSETIRQ SEI STA $0314 STY $0315 CLI RTS;***************;*             *;* FAKE PACMAN *;*             *;***************P1CMAN DEC TIMER2 BNE GORTS LDA #10 DEC HITDOT BEQ N2DOT LDA #15NODOT2 STA TIMER2 BNE N3DOTN2DOT STA TIMER2 LDA #1 STA HITDOTN3DOT LDY #0 JSR EDGE BEQ EDGE7 LDX #4 LDA #0ADF205 STA LOOK,X DEX BNE ADF205 LDX DIR LDA OPPDIR,X TAX STA LOOK,XADF212 JSR RNDDIR JSR CHECK2 BEQ ADF212 JSR CHECK BEQ ADF212 STX DIR JSR CHOMP LDY #0 JMP MOVEEDGE7 LDX DIR JSR CHOMP LDY #0 JMP MOVE;*******************;*                 *;* PUSH BUTTON IRQ *;*                 *;*******************IRQ2 LDA 203 CMP #$3C ; SPACE BAR ALSO STARTS GAME BEQ STTRGA LDA JOY AND #16 CMP #16 BEQ NOBUTTSTTRGA JSR ENTRY JMP ($0318)NOBUTT JMP IRQBUFFER .BYTE $00,$00,$00,$00,$00;**********************;*                    *;* ANIMATION SEQUENCE *;*                    *;**********************ANIMM .BYTE $E6,$E7,$E8,$E9 .BYTE $EA,$E8,$E7,$07 .BYTE $07,$07,$07,$07 .BYTE $07,$07,$AB,$A0 .BYTE $60,$2A,$10,$59 .BYTE $00,$EE,$80,$26 .BYTE $42,$E8,$45,$40 .BYTE $45,$A0,$C8 .BYTE <ANI1,>ANI1 .BYTE <ANI2,>ANI2 .BYTE <ANI3,>ANI3 .BYTE <ANI4,>ANI4 .BYTE <ANI5,>ANI5 .BYTE <ANI6,>ANI6 .BYTE <ANI7,>ANI7 .BYTE <ANI8,>ANI8 .BYTE $20,$20,$20,$20 .BYTE $20,$20,$20,$20ANI1 .BYTE $05,$80,$03,$4C .BYTE $01,$67,$02,$30 .BYTE $04,$30,$01,$10 .BYTE $03,$6C,$04,$68 .BYTE $02,$87,$04,$74 .BYTE $01,$78,$03,$60 .BYTE $01,$33,$03,$20 .BYTE $02,$20,$04,$50 .BYTE $02,$8A,$03,$8D .BYTE $01,$60,$04,$EE .BYTE $01,$3F,$03,$48 .BYTE $02,$3F,$03,$48 .BYTE $02,$21,$04,$90 .BYTE $01,$21,$03,$70 .BYTE $02,$20,$05,$E0 .BYTE $01,$20,$04,$65 .BYTE $03,$65,$02,$20 .BYTE $05,$E0,$04,$99 .BYTE $06,$05,$C0,$01 .BYTE $20,$06,$03,$85 .BYTE $04,$3A,$01,$27 .BYTE $03,$52,$02,$10 .BYTE $08ANI2 .BYTE $05,$00,$05,$34 .BYTE $02,$3E,$05,$02 .BYTE $04,$17,$00ANI3 .BYTE $05,$00,$05,$00 .BYTE $05,$10,$04,$7B .BYTE $02,$0F,$00ANI4 .BYTE $05,$00,$05,$00 .BYTE $05,$00,$05,$72 .BYTE $01,$86,$05,$04 .BYTE $03,$5C,$00ANI5 .BYTE $05,$00,$05,$00 .BYTE $05,$00,$05,$00 .BYTE $05,$9F,$02,$2F .BYTE $04,$50,$02,$13 .BYTE $00ANI6 .BYTE $05,$00,$05,$00 .BYTE $05,$00,$05,$00 .BYTE $05,$00,$05,$00 .BYTE $05,$2A,$01,$69 .BYTE $05,$04,$04,$4A .BYTE $00ANI7 .BYTE $05,$00,$05,$00 .BYTE $05,$00,$05,$00 .BYTE $05,$00,$05,$00 .BYTE $05,$00,$05,$B3 .BYTE $03,$5C,$02,$3F .BYTE $03,$44,$00ANI8 .BYTE $05,$00,$05,$00 .BYTE $05,$00,$05,$00 .BYTE $05,$00,$05,$00 .BYTE $05,$00,$05,$00 .BYTE $05,$00,$05,$33 .BYTE $03,$15,$01,$21 .BYTE $03,$73,$04,$78 .BYTE $05,$C8,$05,$30 .BYTE $03,$78,$04,$78 .BYTE $05,$E4,$05,$00 .BYTE $05,$13,$03,$78 .BYTE $00;******************************;*                            *;* ANIMATE STARTING AT (MAZE) *;*                            *;******************************ANIMAT JSR SHUTUP LDA #0 STA XPOS+21 LDA #1 STA TIMER2 LDA #160 STA POS LDY #56EEEDCE LDA (MAZE),Y STA $0200,Y DEY BPL EEEDCE LDY #6JGJEUU LDA PAGES,Y STA POS+1,Y DEY BPL JGJEUU LDA #7 STA XPOS+39 LDY #6NCGRYQ LDA COLORS,Y STA XPOS+40,Y DEY BPL NCGRYQ LDY #$10UFTFHS LDA LOCAT,Y STA XPOS,Y DEY BPL UFTFHS LDY #8TEIGYM LDA #1 STA TIMER6,Y STA TIMER7,Y LDA #5 STA DIRECT,Y DEY BPL TEIGYM LDX #$11LKJDFL LDA DIREC2,X STA POINT,X DEX BPL LKJDFL LDA #255 STA XPOS+21STAR LDX #7STAR2 LDA MSBS,X STA MSB2 STX TEMP7 DEC TIMER6,X BNE NETXS LDA SPEEDS,X STA TIMER6,X LDA DIRECT,X BEQ NETXS TAX LDY TEMP7 JSR MOVE LDX TEMP7 DEC TIMER7,X BNE NETXS TXA ASL A CLC ADC #POINT STA SOHFH+1 LDY #0SOHFH LDA (00),Y CMP #6 BCS COM LDA #0 BEQ NONONCOM BNE LOIK LDA XPOS+21 EOR MSB2 STA XPOS+21 LDA #1 BNE NONONLOIK RTSNONON STA TEMP1 TXA ASL A TAX LDA POINT,X CLC ADC TEMP1 STA POINT,X LDA POINT+1,X ADC #0 STA POINT+1,X LDA SOHFH+1 STA EWOK+1 LDY #0 LDX TEMP7EWOK LDA (00),Y CMP #6 BCS COM STA DIRECT,X LDA EWOK+1 STA SCOUT+1 INYSCOUT LDA (00),Y STA TIMER7,X TXA ASL A TAX LDA POINT,X CLC ADC #2 STA POINT,X LDA POINT+1,X ADC #0 STA POINT+1,X LDX TEMP7NETXS DEX BMI STAR5 JMP STAR2STAR5 DEC TIMER2 BNE STAR3 LDA #40 STA TIMER2 LDX DIRECT BEQ STAR4 CPX #5 BEQ STAR4 JSR CHOMPSTAR3 JMP STARSTAR4 LDA #160 STA POS JMP STAR;****************************;*                          *;* ASK TO CLEAR HIGH SCORES *;*                          *;****************************ASK LDX #80 LDA #0LOOP50 STA $0200,X DEX BPL LOOP50 JSR VIDEO JSR CLR3 JSR TOP LDX #40LOOP44 LDA #32 STA $05DF,X LDA #1 STA $D9DF,X DEX BNE LOOP44 LDX #5LOOP53 LDA CLEAR-1,X STA $05EA,X DEX BNE LOOP53 LDX #11LOOP52 LDA HISCR+98,X STA $05F0,X DEX BNE LOOP52HITKEY JSR $FFE4 BEQ HITKEY JMP CONTDX *=$3AC0CONTDX PHA LDX #12LOOP73 LDA $05EF,X STA $05F0,X DEX BNE LOOP73 PLA CMP #"Y" BEQ SAVE2;********************;*                  *;* LOAD HIGH SCORES *;*                  *;******************** LDX #7LOOP60 LDA LOAD-1,X STA $05E9,X DEX BNE LOOP60 JSR SETLFS LDA #0 JSR $FFD5 LDA #1 JMP $FFC3;********************;*                  *;* SAVE HIGH SCORES *;*                  *;********************SAVE2 LDX #8LOOP58 LDA CLEAR-1,X STA $05E8,X DEX BNE LOOP58SAVE JSR SETLFS LDX #<HISCR2 LDY #>HISCR2 STX TEMP1 STY TEMP2 LDA #TEMP1 LDX #<HISCR3 LDY #>HISCR3 JSR $FFD8 LDA #1 JMP $FFC3;********************;*                  *;* SET LOGICAL FILE *;*                  *;********************SETLFS LDY #255 LDA #1 LDX #8 JSR $FFBA LDA #8 LDX #<NAME LDY #>NAME JMP $FFBDNAME .BYTE "@:SCORES"CLEAR .BYTE $03,$8C,$85,$81 .BYTE $92,$89,$8E,$87LOAD .BYTE $0C,$8F,$81,$84 .BYTE $89,$8E,$87;***********************;*                     *;* CALCULATE 'ALL TIME *;* HIGH SCORE' ADDRESS *;*                     *;***********************ALL STX TEMP1 LDY #$A5 CPX #11 BCC NOTAB LDY #$B9 TXA SEC SBC #10 TAXNOTAB STY SCREEN LDY #>HISCR STY SCREEN+1 JSR CAL LDX TEMP1 RTS;***********************;*                     *;*  CALCULATE 'TODAYS  *;* HIGH SCORE' ADDRESS *;*                     *;***********************TODAYS STX TEMP1 LDY #$D5 CPX #6 BCC NOTAB2 LDY #$E9 TXA SEC SBC #5 TAXNOTAB2 STY SCREEN LDY #>HISCR+2 STY SCREEN+1 JSR CAL LDX TEMP1 RTS;********************;*                  *;* CALCULATE SCREEN *;* ADDRESS FOR HIGH *;*     SCORES       *;*                  *;********************CAL LDA SCREEN LDY SCREEN+1LOOP59 CLC ADC #40 BCC GJKJKH INYGJKJKH DEX BNE LOOP59 STA SCREEN STY SCREEN+1 RTS;*************************;*                       *;* LIST HIGH SCORE TABLE *;*                       *;*************************GAMOV LDA MAZE LDY MAZE+1 STA BUF2 STY BUF2+1 LDA #<HILEV+1 LDY #>HILEV STA MAZE STY MAZE+1 LDA #0 STA XPOS+21 LDA #200 EOR XSCROL+4 STA XPOS+22 JSR ENTER JSR MAZES JSR ENTRE LDA #<IRQ2 LDY #>IRQ2 JSR SETIRQ LDA #40 LDY #0 LDX #0 JSR WAIT LDA BUF2 LDY BUF2+1 STA MAZE STY MAZE+1 JMP GAMEBUF2 .BYTE $00,$00;**************************;*                        *;* INSERT INTO 'ALL TIME' *;*       GIVEN .X         *;*                        *;**************************ALLINS STX TEMP2 LDX #20 LDA #<ALL LDY #>ALL JMP INS;************************;*                      *;* INSERT INTO 'TODAYS' *;*       GIVEN .X       *;*                      *;************************TODINS STX TEMP2HILEV LDX #10 LDA #<TODAYS LDY #>TODAYS;**********************;*                    *;* INSERT INTO EITHER *;*                    *;**********************INS STA VEC1+1 STA VEC2+1 STY VEC1+2 STY VEC2+2LOOP63 CPX TEMP2 BEQ NSETVEC1 JSR $FFFF LDA SCREEN LDY SCREEN+1 STA SCREEN+2 STY SCREEN+3 DEXVEC2 JSR $FFFF LDY #11LOOP64 LDA (SCREEN),Y STA (SCREEN+2),Y DEY BPL LOOP64 BMI LOOP63NSET RTS;*************************;*                       *;*  GET LENGTH OF SCORE  *;*     IN (SCREEN)       *;*                       *;*************************GETLEN LDX #7 LDY #11LOOP65 LDA (SCREEN),Y CMP #32 BEQ NSET2 DEX DEY BNE LOOP65NSET2 RTS;****************************;*                          *;* COMPARE SCORE WITH SCORE *;*       IN (SCREEN)        *;*                          *;****************************COMPAR STX TEMP1 JSR GETLEN STX TEMP2 LDX #255 LDY #10-DIGITSLOOP66 INX INY LDA SCORE,X CMP #$30 BEQ LOOP66 CPX TEMP2 BNE RRRVSLOOP67 CMP (SCREEN),Y BNE OUTOC INX INY LDA SCORE,X CPX #DIGITS+1 BNE LOOP67OUTOC PHP LDX TEMP1 PLP RTSRRRVS LDA #0 BCS LLDAFF LDA #2LLDAFF CMP #1 BNE OUTOC;***************;*             *;* ENTER SCORE *;*             *;***************ENTER LDA ANI BNE OUTOC STA HIALL STA HITOD LDX #20LOOP68 JSR ALL JSR COMPAR BCC ALLL DEX BNE LOOP68ALLL INX CPX #21 BCS NOALLL STX HIALL JSR ALLINS JSR ALL JSR CLLLRNOALLL LDX #10LOOP69 JSR TODAYS JSR COMPAR BCC TODD DEX BNE LOOP69TODD INX CPX #11 BCS NOTODD STX HITOD JSR TODINS JSR TODAYS JSR CLLLRNOTODD RTSCLLLR STX TEMP1 LDY #11 LDA #32LOOP70 STA (SCREEN),Y DEY BPL LOOP70 LDY #11-DIGITS LDX #0LOOP71 LDA SCORE,X CMP #$30 BNE KGDGD INX INY BNE LOOP71KGDGD LDA SCORE,X STA (SCREEN),Y INX INY CPY #12 BNE KGDGD LDX TEMP1 RTS;**************;*            *;* ENTER NAME *;*            *;**************ENTRE LDA ANI BNE FUCK LDX HIALL BEQ FUCK2 JSR ALL LDA SCREEN LDY SCREEN+1 STA SCREEN+2 STY SCREEN+3 STA SCREEN+6 TYA SEC SBC #>HISCR-4 STA SCREEN+7FUCK2 LDX HITOD BEQ FUCK3 JSR TODAYS LDA SCREEN LDY SCREEN+1 STA SCREEN+4 TYA SEC SBC #>HISCR-4 STA SCREEN+5 JMP OKFUCKFUCK3 LDA HIALL BNE OKFUCKFUCK RTSOKFUCK LDA #<IRQ3 LDY #>IRQ3 JSR SETIRQ LDX #3LOOP72 LDA SCORE-3,X INX CMP #$30 BNE HITKK BEQ LOOP72HITKK STX TEMP1 LDY #0HITK STY TEMP2HITK2 JSR $FFE4 BEQ HITK2 LDY TEMP2 CMP #13 BEQ OUFUCK CMP #20 BEQ DELKEY CMP #32 BCC HITK CMP #219 BCS HITK CMP #64 BCC KJHF AND #159 EOR #128KJHF LDX HITOD BEQ GETLOS STA (SCREEN),Y STA (SCREEN+4),YGETLOS LDX HIALL BEQ GETLO2 STA (SCREEN+2),Y STA (SCREEN+6),YGETLO2 CMP #0 BEQ GETLO3 INYGETLO3 CPY TEMP1 BNE HITKOUFUCK LDA HIALL BEQ FUCKIT JMP SAVEFUCKIT RTSDELKEY CPY #0 BEQ DELK DEYDELK LDA #0 BEQ KJHF;*****************;*               *;* NO RETURN IRQ *;*               *;*****************IRQ3 JSR PILLS LDA JOY AND #16 CMP #16 BEQ GJEA31 LDA #$1B STA SMOOTH JSR ENTRY JMP ($0318)GJEA31 JMP $EA31;******************;*                *;* STOP KEY CHECK *;*                *;******************STOPK LDA 203 CMP #$26 ; CHECK O POWER PILL CHEAT PRESSED BNE N4NN1 JSR CHEAT2 LDA #20 STA PTIMER STA PTIMER+1NN71W RTSN4NN1 CMP #$29 ; CHECK PAUSE P PRESSED BNE NNNN1NNNN2 LDA #0 STA SOUND+24LKK LDA 203 CMP #$3C ; SPACE BAR UNPAUSES BNE LKK LDA #15 STA SOUND+24 RTSNNNN1 CMP #$21 ; I FOR INFINITE MEN BNE NN72W LDA #10 STA MEN JMP TOPNN72W CMP #$2A ; L FOR NEXT LEVEL BNE NN71W LDA #0 STA DOTS RTS;****************;*              *;* CLEAR SCREEN *;*              *;****************CLR3 LDX #0LOOP99 LDA #0 STA $C000,X STA $C100,X STA $C200,X STA $C300,X LDA #1 STA $C400,X STA $C500,X STA $C600,X STA $C700,X INX BNE LOOP99 JMP CLR;***********************;*                     *;* SCROLL HORROR STORY *;*                     *;***********************WAIX2 LDX #$45 ; SCROLL SPEED. 70 SLOW. 30 FAST LDA $DC01 CMP #$EF BNE SPACE2 LDX #$02SPACE2 LDA #1 JMP WAITSAYMSG LDX #39CLR981 LDA #32 STA $0400,X LDA #1 STA $D800,X DEX BPL CLR981 LDA #<MSG LDY #>MSG STA SCREEN STY SCREEN+1 LDA #25 STA TEMP3 LDA #1 LDX #0 STX TEMP2 JSR WAIT LDA #$17 STA SMOOTHLOOPA2 LDA #8 STA TEMP1LOOPA1 LDA #1 TAY JSR WAIX2WAITRS LDA $D012 CMP #3 BCS WAITRS DEC SMOOTH DEC TEMP1 BNE LOOPA1 LDA #$17 STA SMOOTH LDA #>$0400 STA PRGSL1+2 STA PRGSL2+2 LDX #0 LDY #4PRGSL1 LDA $0428,XPRGSL2 STA $0400,X INX BNE PRGSL1 INC PRGSL1+2 INC PRGSL2+2 DEY BNE PRGSL1 LDA TEMP2 BEQ DOTNK LDA #32 LDY #39AXSM STA $07C0,Y DEY BPL AXSM BMI CKSADOTNK LDY #39LOOPA9 LDA (SCREEN),Y BNE ENDSD INC TEMP2ENDSD CMP #"'" BNE SDSDQ LDA #$22SDSDQ CMP #";" BNE SDSDW LDA #"'"SDSDW CMP #64 BCC PRTAXQ AND #159 EOR #128PRTAXQ STA $07C0,Y DEY BPL LOOPA9 LDA SCREEN CLC ADC #40 STA SCREEN BCC LOOPA2 INC SCREEN+1 BCS LOOPA2CKSA DEC TEMP3 BNE LOOPA2 LDA #4 LDX #0 LDY #0 JSR WAIT LDA #$1B STA SMOOTH RTSMSG .BYTE "               …NSTRUCTIONS             " .BYTE "                                        " .BYTE "     ’SE JOYSTICK PORT  TWO.   ÕOVE     " .BYTE "     ”NACKMAN THROUGH  MAZE  EATING     " .BYTE "     DOTS  WHILE   AVOIDING  ENEMY.     " .BYTE "                                        " .BYTE "     ≈AT  POWER  PILLS   TO  ATTACK     " .BYTE "     ENEMIES. ‘HEY ARE  WORTH  200,     " .BYTE "     400,  800,  AND  1600  POINTS.     " .BYTE "                                        " .BYTE "     ‘HERE  ARE   SEVEN   DIFFERENT     " .BYTE "     BONUSES,   EIGHT   TYPES    OF     " .BYTE "     ENEMIES   AND   TEN  DIFFERENT     " .BYTE "     MAZES.                             " .BYTE "                                        " .BYTE "                                        " .BYTE "                √ONTROLS                " .BYTE "                                        " .BYTE "                                        " .BYTE "                   ’P                   " .BYTE "                                        " .BYTE "                    ‘                   " .BYTE "          ÃEFT   ∆     »   “IGHT        " .BYTE "                    «                   " .BYTE "                                        " .BYTE "                  ƒOWN                  " .BYTE "                                        " .BYTE "                                        " .BYTE "                                        " .BYTE "                √HEAT ÀEYS              " .BYTE "                                        " .BYTE "         œ ‘URN GHOSTS BLUE             " .BYTE "         … 10 ≈XTRA MEN                 " .BYTE "         Ã ”KIP TO NEXT LEVEL           " .BYTE "         – –AUSE                        " .BYTE "         ”PACE ’NPAUSE                  " .BYTE "                                        " .BYTE "                                        " .BYTE "     –RESS “≈”‘œ“≈ TO RESTART GAME.     " .BYTE "                                        " .BYTE "     –RESS ¬UTTON TO START.             " .BYTE "                                        " .BYTE 0,0,0,"     ≈Œ œŸ...                        ";FORSTF .BYTE "œPENING TITLE MESSAGE                  ";       .BYTE "                                        ";       .BYTE "                                        ";FOREND.FILE SNACKMAN.5