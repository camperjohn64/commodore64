 *=$0801 MSB=$D010 JOY=$DC00 DIR=$02C0 POS=$07F8 MEN=$02C1 ANI=$02D5 XPOS=$D000 YPOS=$D001 PACX=$0223 PACY=$0224 MSB2=$4E FLAG=$02 DOTS=$0227 MAZE=$FD BON1=$0208 BON2=$02FF BON3=$0209 BON4=$020B BON5=$020D BON6=$021E BON7=$021F BON8=$0220 BON9=$0201 TEMP1=$03 TEMP2=$04 TEMP3=$05 TEMP4=$06 TEMP5=$07 TEMP6=$08 TEMP7=$09 TEMP8=$0A HIALL=$FB HITOD=$FC PTIME=$0203 SOUND=$D400 SCORE=$0340 SFLAG=$02C9 LEVEL=$02D4 ASPRIN=$20 MSPEED=$020F STEMP1=$02CA STEMP2=$02CB STEMP3=$02CC BTEMP1=$02CE BTEMP2=$02CF TIMER1=$02C2 TIMER2=$02C3 TIMER4=$02CD TIMER5=$02D0 BONUSC=$0228 BONUSL=$0229 PTIMER=$02C4 SCREEN=$5F HITDOT=$02C6 DIGITS=6 NUMBER=$15 BONSPD=$02D1 BONDIR=$02D2 BMODE=$02D3 SMOOTH=$D011;****************;*              *;* GHOST LABLES *;*              *;**************** RND=$034A TIMER3=RND SPEED=TIMER3+4 MODE=SPEED+4 GDIR=MODE+4 LOOK=GDIR+4 HOUSE=LOOK+4 TSPEED=HOUSE+4 EVERY8=TSPEED+4 SKILL=$0202 OUTHO=$0203 HOUSEX=$0221 HOUSEY=$0222 GRAPIC=$020F COLOUR=$0216 GPOINT=$02C7 AXIS=$14;********************;*                  *;* ANIMATION LABLES *;*                  *;******************** PAGES=$0200 COLORS=$0207 LOCAT=$020E DIREC2=$021F SPEEDS=$022F POINT=ASPRIN TIMER6=RND+1 TIMER7=TIMER6+8 DIRECT=TIMER7+8;*****************;*               *;* 10 SYS (2064) *;*               *;***************** .BYTE $0E,$08,$0A,$00 .BYTE $9E,$20,$28,$32 .BYTE $30,$36,$34,$29 .BYTE $00,$00,$00;***********************;*                     *;*     PAC MAN GAME    *;*                     *;*  BY JOHN MCCARTHY   *;*                     *;*********************** SEI CLD LDX #255 TXS JSR ENTRY JSR SETUP JSR ASK JSR SETUPGAME JSR TITLEGAME2 LDX #255 TXS CLI JSR SHUTUP JSR ENTRY JSR SETUP JSR MAZESNEW JSR VIDEO JSR TOP JSR READY JSR VOICE2LOOP5 JSR DEATH JSR GHOST JSR BONUS JSR DEATH JSR SOUNDS JSR PACMAN JSR STOPK LDY MSPEEDLOOP47 DEY BNE LOOP47 LDA DOTS BNE LOOP5;********************;*                  *;* CREATE NEXT MAZE *;*                  *;******************** LDA #160 STA POS JSR SHUTUP LDA MSPEED CLC SBC #8 CMP #16 BCS SPSTOR LDA #16SPSTOR STA MSPEED LDA MAZE CLC ADC #15 STA MAZE LDA MAZE+1 ADC #0 STA MAZE+1 INC LEVEL LDA #6 LDX #0 LDY #0 JSR WAIT LDA #1 STA XPOS+21 LDX #4LOOP56 LDA GRAPIC,X CLC ADC #1 AND #7 ORA #$C0 STA GRAPIC,X DEX BNE LOOP56 LDA #3 LDX #0 LDY #0 JSR WAIT LDA #0 STA XPOS+21 JSR RESET JSR MAZES JMP NEWREADY LDA #6 LDX #0 LDY #0 JMP WAIT;******************;*                *;* COMPUTER SETUP *;*                *;******************ENTRY CLD LDA #<IRQ LDY #>IRQ JSR SETIRQ LDX #8 LDA #<GAME2 STA $0310,X LDA #>GAME2 STA $0311,X LDA #64 STA $DC05LOOP1 LDA RESTOR,X STA $8000,X DEX BPL LOOP1 LDA #128 STA $0291 LDA #127 STA $028A RTSRESTOR .BYTE <SCREW,>SCREW .BYTE <SCREW,>SCREW .BYTE $C3,$C2,$CD,$38 .BYTE $30SCREW LDA #<SCREW2 LDY #>SCREW2 STA $0318 STY $0319 LDA #0 STA XPOS+32 LDA #11 STA XPOS+17SCREW2 JMP SCREW2;***************;*             *;* GAME SET UP *;*             *;***************SETUP LDX #21LOOP15 LDA SET1,X STA DIR,X DEX BPL LOOP15 LDX #43LOOP20 LDA SET2,X STA SCORE,X DEX BPL LOOP20 LDA #<LEVELS LDY #>LEVELS STA MAZE STY MAZE+1 LDA #80 STA MSPEED LDX #3LOOP55 LDA GOOA,X STA GRAPIC+1,X DEX BPL LOOP55 LDA #15 STA SOUND+24 LDX #10 LDA #0CLRMZX STA MZDONE,X DEX BPL CLRMZX RTSGOOA .BYTE $C0,$C1,$C2,$C3MZDONE .BYTE 0,0,0,0,0,0,0,0,0,0,0;***************;*             *;* MAZE SET UP *;*             *;***************MAZES SEIBJIUYR LDY #14LOOP21 LDA (MAZE),Y STA $0200,Y DEY BPL LOOP21 LDA PAGES CMP #$4C BNE NMAX LDA $0201 LDY $0202 STA MAZE STY MAZE+1 JMP BJIUYRNMAX TAX LDA DOTCOL,X STA CO1+1 LDA PILLCO,X STA CO2+1 LDA MZDONE,X STA TEMPAS INC MZDONE,X TXA ASL A ASL A CLC ADC #>BOURDS STA SCREEN+1 LDA #<BOURDS STA SCREEN LDY #40LOOP49 LDA (SCREEN),Y STA HOUSEX,Y DEY BPL LOOP49 LDA #0 LDY #$C0 STA SCREEN+2 STY SCREEN+3 LDY #$C4 STA SCREEN+4 STY SCREEN+5 LDA #0 STA NUMBER LDY #$28LOOP22 LDA (SCREEN),YCO1 LDX #0 CMP #$6C BEQ STORE CMP #$7B BEQ STORE LDX #1 CMP #$1B BEQ ADDPIL CMP #$1D BNE STOREADDPIL STA TEMP1 LDX NUMBER TYA STA ASPRIN+2,X INX LDA SCREEN+3 AND #3 ORA #4 STA ASPRIN+2,X INX STX NUMBERCO2 LDX #0 LDA TEMP1STORE CMP #$60 BNE STR2 LDA TEMPAS BNE STR3 LDA #$60 .BYTE $2CSTR3 LDA #$20STR2 STA (SCREEN+2),Y TXA STA (SCREEN+4),Y INY BNE LOOP22 INC SCREEN+1 INC SCREEN+3 INC SCREEN+5 LDX SCREEN+3 CPX #$C4 BCC LOOP22 LDX #4LOOP61 LDA GRAPIC,X AND #7 TAY LDA GOOCOL,Y STA COLOUR,X DEX BNE LOOP61 LDA CO1+1 LDX #0LOOP74 CMP XCOLLL,X BEQ AQHQ INX BNE LOOP74AQHQ STX PAGES LDA #200 EOR XSCROL,X STA XPOS+22 CLI JMP CLRXSCROL .BYTE 0,1,1,0,0,1PILLCO .BYTE $0D,$0F,$0D,$0F .BYTE $03,$0F,$0D,$03 .BYTE $0F,$03,$03DOTCOL .BYTE $03,$07,$0A,$03 .BYTE $02,$0D,$03,$05 .BYTE $02,$07,$0DGOOCOL .BYTE $0A,$03,$0D,$0E .BYTE $0A,$03,$0D,$03XCOLLL .BYTE $03,$07,$0A,$02 .BYTE $0D,$05TEMPAS .BYTE 0;*******************;*                 *;* SET UP TOP LINE *;*                 *;*******************TOP LDX #39 LDA #32LOOP24 STA $0400,X DEX BNE LOOP24 LDX #5LOOP23 LDA QUOTE,X STA $0400,X LDA QUOTE2,X STA $041D,X LDA #1 STA $D800,X STA $D81D,X DEX BPL LOOP23 LDX #3 LDY #0 LDA LEVELAD5220 STY TEMP1AD5162 CMP #10 BCC AD5170 SEC SBC #10 INC TEMP1 BNE AD5162AD5170 CLC ADC #$30 STA $0423,X LDA #1 STA $D823,X LDA TEMP1 DEX BNE AD5220 LDX #0LOOP25 LDA SCORE,X CMP #$30 BNE CONT LDA #0 STA $D806,X INX CPX #DIGITS BNE LOOP25CONT LDA SCORE,X STA $0406,X LDA #1 STA $D806,X INX CPX #DIGITS+1 BCC CONT LDX MEN BEQ NOMEN TXA ASL A TAX CPX #14 BCC UNDER5 LDX #14UNDER5 LDA #$69 STA $0407+DIGITS,X LDA #$1D STA $0407+DIGITS+1,X LDA #7 STA $D807+DIGITS,X STA $D807+DIGITS+1,X DEX DEX BNE UNDER5NOMEN LDA #$30 STA $0407+DIGITS LDA #1 STA $D807+DIGITS RTS;*********************;*                   *;* VIDEO CHIP SET UP *;*                   *;*********************VIDEO LDA #0 STA MSB STA XPOS+21 STA XPOS+23 STA XPOS+29 STA XPOS+30 STA XPOS+31 STA XPOS+32 STA XPOS+33 LDA #24 STA XPOS+24 LDA #27 STA XPOS+17 LDA #200 STA XPOS+25 LDA BON9 AND #15 JSR STAY LDX #7LOOP33 LDA GRAPIC,X STA POS,X LDA COLOUR,X STA XPOS+39,X DEX BNE LOOP33 LDA HOUSEX STA XPOS+2 SEC SBC #24 LDX #6LOOP34 STA XPOS+2,X CLC ADC #24 TAY LDA HOUSEY STA YPOS+2,X TYA DEX DEX BNE LOOP34 LDA HOUSEY SEC SBC #16 STA YPOS+2 LDA PACX STA XPOS LDA PACY STA YPOS LDA #160 STA POS LDA #31 STA XPOS+21 LDA #7 STA XPOS+39 LDX PAGES LDA XSCROL,X AND #1 BEQ JGJG LDX #8KKMJN INC XPOS,X DEX DEX BPL KKMJNJGJG RTS;*********************;*                   *;* SOUND CHIP SHUTUP *;*                   *;*********************SHUTUP LDX #23 LDA #0LOOP43 STA SOUND,X DEX BPL LOOP43 RTSQUOTE .BYTE $13,$83,$8F,$92 .BYTE $85,$3AQUOTE2 .BYTE $0C,$85,$96,$85 .BYTE $8C,$3ASET1 .BYTE $03,$04,$01,$01 .BYTE $00,$00,$00,$00 .BYTE $FF,$00,$00,$00 .BYTE $00,$01,$00,$00 .BYTE $01,$01,$02,$00 .BYTE $01,$00SET2 .BYTE $30,$30,$30,$30 .BYTE $30,$30,$30,$30 .BYTE $30,$30,$30 .BYTE $01,$01,$01,$01 .BYTE $0D,$0F,$0F,$0F .BYTE $00,$00,$00,$00 .BYTE $02,$03,$03,$04 .BYTE $00,$00,$00,$00 .BYTE $00,$01,$01,$01 .BYTE $01,$01,$01,$01 .BYTE $01,$01,$01,$01;*******;*     *;* IRQ *;*     *;*******IRQ JSR RNDNUM JSR PILLS JSR $FFE4 CMP #133 BNE ADEA31 LDX PAGES LDA XSCROL,X EOR #1 STA XSCROL,X LDA XPOS+22 EOR #1 STA XPOS+22 LDY TEMP1 LDA TEMP2 LDX TEMP3 STY $E0 STA $E1 STX $E2 LDA MSB STA $E3 LDY #7KHDSDJ LDA XPOS+22 AND #1 CLC ADC #3 STY TEMP3 TAX JSR MOVE LDY TEMP3 DEY BPL KHDSDJ LDY $E0 LDA $E1 LDX $E2 STY TEMP1 STA TEMP2 STX TEMP3 LDA $E3 STA MSBADEA31 JMP $EA31;*****************;*               *;* RANDOM NUMBER *;*               *;*****************RNDNUM LDA RND EOR $A2 ROR A ROR A EOR $DE00,Y ROL A EOR $DE00,X ADC $D012 STA RND RTS;******************************;*                            *;*     THIS ROUTINE PRINTS    *;*    SQUARES STARTING FROM   *;*   THE CENTER OF THE SCREEN *;*    AND CONTINUES OUTWARD   *;*   IN SEMI-RANDOM COLOURS.  *;*                            *;*  THE TOP LINE IS UNTOUCHED *;*                            *;******************************CLR LDA #0 STA XPOS+21 JSR RNDNUM AND #7 TAY LDX #1LOOP81 LDA COLOU2,Y JSR BOX LDA #1 LDX #25 LDY #0 JSR WAIT JSR LDREG INY CPY #10 BNE N1LOOP LDY #0N1LOOP INX CPX #13 BNE LOOP81 SEI LDX #1LOOP82 JSR BOX2 LDA #1 LDX #21 LDY #0 JSR WAIT JSR LDREG INX CPX #13 BNE LOOP82 CLI JMP TOPCOLOU2 .BYTE $02,$07,$0F,$03 .BYTE $05,$08,$06,$0D .BYTE $0C,$0E;***************************;*                         *;*  THIS ROUTINE PRINTS    *;*  A SINGLE SQUARE GIVEN  *;* .X FOR WHICH SQUARE AND *;* .A FOR COLOUR           *;*                         *;* .Y IS NOT USED OR LOST  *;*                         *;*   RING SIZES ARE 1-13   *;*                         *;***************************BOX STA TEMP1 STX TEMP2 STY TEMP3 LDA #12 SEC SBC TEMP2 TAY LDX #0 JSR CAL4 LDA #11 CLC ADC TEMP2 TAY LDX #4 JSR CAL4 LDA #27 CLC ADC TEMP2 STA TEMP4 LDA #12 SEC SBC TEMP2 STA TEMP6 TAYLOOP83 LDA #160 STA (SCREEN),Y STA (SCREEN+4),Y LDA TEMP1 STA (SCREEN+2),Y STA (SCREEN+6),Y INY CPY TEMP4 BNE LOOP83 LDA TEMP2 ASL A TAXLOOP84 LDY TEMP4 LDA #160 STA (SCREEN),Y LDA TEMP1 STA (SCREEN+2),Y LDY TEMP6 LDA #160 STA (SCREEN),Y LDA TEMP1 STA (SCREEN+2),Y LDA SCREEN CLC ADC #40 BCC NOHI12 INC SCREEN+1 INC SCREEN+3NOHI12 STA SCREEN STA SCREEN+2 DEX BNE LOOP84LDREG LDA TEMP1 LDX TEMP2 LDY TEMP3 RTS;***************************;*                         *;* THIS ROUTINE CALCULATES *;*   THE SCREEN ADDRESS    *;*  GIVEN .Y DOWNWARD AND  *;*    .X TO BE STORED AT   *;*        SCREEN,X         *;*                         *;***************************CAL4 LDA #4 STA SCREEN+1,X LDA #216 STA SCREEN+3,X LDA #0LOOP85 CLC ADC #40 BCC NOHI4 INC SCREEN+1,X INC SCREEN+3,XNOHI4 DEY BPL LOOP85 STA SCREEN,X STA SCREEN+2,X RTS;**************;*            *;* PRINT MAZE *;*            *;**************BOX2 STA TEMP1 STX TEMP2 STY TEMP3 LDA #12 SEC SBC TEMP2 STA TEMP4 TAY LDX #0 JSR CAL4 LDA #28 CLC ADC TEMP2 STA TEMP5 LDA TEMP2 ASL A TAX LDA SCREEN STA SCREEN+4 STA SCREEN+6 LDA SCREEN+1 CLC ADC #$BC STA SCREEN+5 ADC #4 STA SCREEN+7LOOP90 LDY TEMP4LOOP91 LDA (SCREEN+4),Y STA (SCREEN),Y LDA (SCREEN+6),Y STA (SCREEN+2),Y INY CPY TEMP5 BCC LOOP91 LDA SCREEN CLC ADC #40 STA SCREEN STA SCREEN+2 STA SCREEN+4 STA SCREEN+6 BCC ASCII INC SCREEN+1 INC SCREEN+3 INC SCREEN+5 INC SCREEN+7ASCII DEX BNE LOOP90 RTS .FILE SNACKMAN.2